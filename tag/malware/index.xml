<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Malware | Faximilie</title><link>/tag/malware/</link><atom:link href="/tag/malware/index.xml" rel="self" type="application/rss+xml"/><description>Malware</description><generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><lastBuildDate>Sun, 01 Jan 2017 00:00:00 +0000</lastBuildDate><image><url>img/map[gravatar:%!s(bool=false) shape:circle]</url><title>Malware</title><link>/tag/malware/</link></image><item><title>Malware: a Crash Course</title><link>/publication/malware-a-crash-course/</link><pubDate>Sun, 01 Jan 2017 00:00:00 +0000</pubDate><guid>/publication/malware-a-crash-course/</guid><description/></item><item><title>Malware a Crash Course</title><link>/slides/malware-a-crash-course/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/slides/malware-a-crash-course/</guid><description>&lt;h1 id="malware-a-crash-course">Malware: a Crash Course&lt;/h1>
&lt;hr>
&lt;h2 id="what-is-malware">What is malware&lt;/h2>
&lt;ul>
&lt;li>Any malicious software&lt;/li>
&lt;li>Worms, viruses, trojans, etc&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="who-makes-malware">Who makes malware&lt;/h2>
&lt;ul>
&lt;li>Russians&lt;/li>
&lt;/ul>
&lt;aside class="notes">
Russian law where they only charge people who commit cybercrime against Russians
Effective method of avoiding infection is to set your default language to Russian
&lt;/aside>
&lt;ul>
&lt;li>teenagers from US, CA, UK, and AU&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="overview-of-terms">Overview of terms&lt;/h2>
&lt;ul>
&lt;li>Terms are not mutually exclusive&lt;/li>
&lt;li>malware can leverage different features and be labeled different ways&lt;/li>
&lt;/ul>
&lt;h2 id="trojans">Trojans&lt;/h2>
&lt;ul>
&lt;li>Malware hidden in legitimate software&lt;/li>
&lt;li>Usually done by binding or backdooring legitimate software&lt;/li>
&lt;li>Usually found in torrents&lt;/li>
&lt;/ul>
&lt;h2 id="worms">Worms&lt;/h2>
&lt;ul>
&lt;li>Malware that automatically spreads without user interaction&lt;/li>
&lt;li>Usually exploits network vulnerabilities&lt;/li>
&lt;li>Not common anymore, although Wannacry was an exception&lt;/li>
&lt;/ul>
&lt;h2 id="spyware">Spyware&lt;/h2>
&lt;ul>
&lt;li>Spyware is malware that is often legitimate in some respect&lt;/li>
&lt;li>but will steal and siphon data away&lt;/li>
&lt;/ul>
&lt;h2 id="viruses">Viruses&lt;/h2>
&lt;ul>
&lt;li>Self replicating malware&lt;/li>
&lt;li>The term is not often used outside of pop culture as it&amp;rsquo;s ill defined&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="major-types-of-malware">Major types of malware&lt;/h2>
&lt;h2 id="rootkits">Rootkits&lt;/h2>
&lt;ul>
&lt;li>Complicated methods of hiding aspects of malware&lt;/li>
&lt;li>Usually hiding files, registry keys, and network connections from the system&lt;/li>
&lt;li>Usually Ring3 (userland) based&lt;/li>
&lt;li>Sometimes Ring0 (kernal) based&lt;/li>
&lt;li>Very occasionally a bootkit (bios rootkit)&lt;/li>
&lt;/ul>
&lt;h3 id="rings">Rings&lt;/h3>
&lt;ul>
&lt;li>Rings are the level of access&lt;/li>
&lt;li>there&amp;rsquo;s usually two major ones
&lt;ul>
&lt;li>Ring 3 - The userland where most applications will run&lt;/li>
&lt;li>Ring 0 - The kernel where most drivers and the operating system will run&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Having a lower ring means you can hook System calls first&lt;/li>
&lt;/ul>
&lt;h3 id="system-calls">System calls&lt;/h3>
&lt;ul>
&lt;li>System calls are what applications use to communicate with the OS and hardware&lt;/li>
&lt;li>there are system calls for reading files, making network connections, etc&lt;/li>
&lt;li>All abstracted to be non-hardware specific&lt;/li>
&lt;/ul>
&lt;h3 id="hooking">Hooking&lt;/h3>
&lt;ul>
&lt;li>Rootkits work by hooking system calls and intercepting the data between the OS
and the application&lt;/li>
&lt;li>There are a LOT of ways to do this&lt;/li>
&lt;li>They often go down the chain, where the first hook will be called first&lt;/li>
&lt;li>Thus getting the first hook is crucial in correctly intercepting data&lt;/li>
&lt;li>Anti-viruses will also hook system calls to check for rootkits and suspicious behavior&lt;/li>
&lt;/ul>
&lt;h2 id="loaders">Loaders&lt;/h2>
&lt;ul>
&lt;li>Malware specifically designed to provide strong persistence on a compromised system&lt;/li>
&lt;li>It&amp;rsquo;s job is to make sure no Anti-Virus or User can remove it&lt;/li>
&lt;li>It often utilizes rootkits to achieve it&amp;rsquo;s goal&lt;/li>
&lt;li>It only exists to provide baseline persistence and load more specialized
malware onto a system&lt;/li>
&lt;li>a Prominent example is Smoke Loader&lt;/li>
&lt;/ul>
&lt;h2 id="rats">RATs&lt;/h2>
&lt;ul>
&lt;li>Remote Administration Trojans&lt;/li>
&lt;li>Truely the most prolific malware type&lt;/li>
&lt;li>Used by teenagers to dip their toe into cybercrime&lt;/li>
&lt;li>They provide intimate access to a compromised computer as opposed to more
sophisticated malware such as botnets&lt;/li>
&lt;li>Allowing remote desktop, access to the webcam, keylogger, chats, and even
functions to troll the user (ejecting CD drive)&lt;/li>
&lt;li>Relatively cheap $20 a license with the ability to generate new payloads at will&lt;/li>
&lt;li>Most prominent RATs are:
&lt;ul>
&lt;li>Blackshades&lt;/li>
&lt;li>DarkComet&lt;/li>
&lt;li>jRAT&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="botnets">Botnets&lt;/h2>
&lt;ul>
&lt;li>Botnet is an umbrella term for malware that is designed to collect a large
amount of compromised hosts and create a network of bots&lt;/li>
&lt;li>They&amp;rsquo;re often another type of malware in conjunction with this&lt;/li>
&lt;li>They&amp;rsquo;re designed for controlling thousands if not millions of compromised hosts&lt;/li>
&lt;li>Very expensive, $100s of dollars for a payload to be generated by the author&lt;/li>
&lt;li>This is in stark contrast to RATs&lt;/li>
&lt;li>Prominent examples are:
&lt;ul>
&lt;li>Betabot&lt;/li>
&lt;li>Andromeda&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="banking-trojans">Banking Trojans&lt;/h2>
&lt;ul>
&lt;li>Banking trojans are unique and powerful&lt;/li>
&lt;li>They&amp;rsquo;re specifically designed to defeat all verifications banks put in their
web pages&lt;/li>
&lt;li>They can defeat encryption by hooking browser networking functions&lt;/li>
&lt;li>intercept HTTP(S) POST requests skimming data (logins, credit
card numbers, etc)&lt;/li>
&lt;li>intercept incoming HTTP(S) traffic and inject malicious javascript&lt;/li>
&lt;li>They can then automatically siphon money from the account and hide the transactions&lt;/li>
&lt;li>All generally cloned from zeus&amp;rsquo;s leaked source code&lt;/li>
&lt;li>Absurdly expensive, usually upwards of $1000 for a single payload generated by sellers&lt;/li>
&lt;li>Prominent examples:
&lt;ul>
&lt;li>Zeus&lt;/li>
&lt;li>SpyEye&lt;/li>
&lt;li>Citadel&lt;/li>
&lt;li>Kronus&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="pos-malware">POS malware&lt;/h2>
&lt;ul>
&lt;li>Attacks Point of sales machines&lt;/li>
&lt;li>Constantly scans memory for credit card numbers&lt;/li>
&lt;li>Where most credit cards are stolen from&lt;/li>
&lt;/ul>
&lt;h2 id="ransomware">Ransomware&lt;/h2>
&lt;ul>
&lt;li>Also known as Cryptolockers&lt;/li>
&lt;li>Restrict access to the system and demand a payment&lt;/li>
&lt;li>Usually this is done by encrypting files&lt;/li>
&lt;li>Very common these days&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="design-choices">Design choices&lt;/h2>
&lt;h2 id="os-choice">OS Choice&lt;/h2>
&lt;ul>
&lt;li>Malware is often only made for windows as it represents the largest market share&lt;/li>
&lt;li>This is not to say there isn&amp;rsquo;t malware for Linux/MacOS/BSD, they are just much
less common&lt;/li>
&lt;/ul>
&lt;h2 id="language-choice">Language choice&lt;/h2>
&lt;ul>
&lt;li>Malware is often written in C, C++, Delphi, and VB6&lt;/li>
&lt;li>This is to avoid depending on libraries having being installed on the system
(.NET or Java)&lt;/li>
&lt;/ul>
&lt;h2 id="compactness-and-modularity">Compactness and modularity&lt;/h2>
&lt;ul>
&lt;li>Malware is often designed to be compact and small to allow it to be downloaded
remotely over slow connections&lt;/li>
&lt;li>This leads to modularization, lots of complicated malware will segment it&amp;rsquo;s
capabilities into modules that will be loaded when needed&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="side-note-crypters">Side note: Crypters&lt;/h2>
&lt;ul>
&lt;li>Crypters encrypt payloads to avoid anti-virus detection&lt;/li>
&lt;li>Relatively cheap&lt;/li>
&lt;li>When no Anti-virus detects it it&amp;rsquo;s called FUD&lt;/li>
&lt;li>Protection only lasts a few weeks, so older files are safer.&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="infection-vectors">Infection Vectors&lt;/h2>
&lt;ul>
&lt;li>There are a lot of ways people look to infect victims with a malicious payload&lt;/li>
&lt;li>Each type of malware usually has a specific method of infection designed to
target specific demographics&lt;/li>
&lt;/ul>
&lt;h2 id="pirated-software">Pirated software&lt;/h2>
&lt;ul>
&lt;li>Pirated software is commonly infected, usually a malicious payload is
binded to existing torrents, crypted to avoid detection, and uploaded.&lt;/li>
&lt;li>Sites like the pirate bay are pretty good at taking down infected uploads&lt;/li>
&lt;li>KAT is not so great&lt;/li>
&lt;li>This is mainly used by owners of RAT networks, as it&amp;rsquo;s easy and low cost.&lt;/li>
&lt;/ul>
&lt;h2 id="drive-bys">Drive bys&lt;/h2>
&lt;ul>
&lt;li>A common method botnet owners use to gain a large number of infected hosts&lt;/li>
&lt;li>Has 3 major components
&lt;ul>
&lt;li>Exploit kit&lt;/li>
&lt;li>Compromised sites&lt;/li>
&lt;li>Payload&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Often used to target 3rd world countries&lt;/li>
&lt;/ul>
&lt;h3 id="exploit-kit">Exploit Kit&lt;/h3>
&lt;ul>
&lt;li>An exploit kit is a piece of software designed to select an exploit that will
be effective against an unpatched piece of software (IE 8, old flash, etc)&lt;/li>
&lt;li>They are usually rented on a daily basis for $300+/day&lt;/li>
&lt;li>RIG Exploit Kit is the most common used&lt;/li>
&lt;/ul>
&lt;h3 id="legitimate-compromised-site">Legitimate Compromised site&lt;/h3>
&lt;ul>
&lt;li>You need to get traffic to an exploit kit&lt;/li>
&lt;li>This is usually done through exploiting legit sites and placing iframes to the
exploit kit&lt;/li>
&lt;li>Sometimes done through malicious advertisements as well&lt;/li>
&lt;/ul>
&lt;h3 id="the-payload">The payload&lt;/h3>
&lt;ul>
&lt;li>Often the space to run code after an exploit is small&lt;/li>
&lt;li>Often just enough to download and execute an additional stage&lt;/li>
&lt;/ul>
&lt;h2 id="malicious-mail-attachments">Malicious mail attachments&lt;/h2>
&lt;ul>
&lt;li>Saw a dip in popularity during the early 2000s&lt;/li>
&lt;li>On the rise with cryptolockers&lt;/li>
&lt;li>Usually abuse Word macros to execute payloads&lt;/li>
&lt;li>Often targeting business specifically&lt;/li>
&lt;/ul></description></item></channel></rss>